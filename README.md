# Project 2 - Machine Learning Course
## Data-driven surrogate modeling of the hemodynamics by prediction of POD coefficients (3D Navier-Stokes equations)

#### Authors: Marianna Dell'Otto, Massimo Rizzuto, Nur Cristian Sangiorgio
#### Tutor: Riccardo Tenderini

## General description
This project is part of the course CS-433 "Machine Learning" at EPFL and it is done in collaboration with the SCI SB SD Group at EPFL.
The goal of this project is to predict the POD coefficients of hemodynamics variables (velocity and pressure) in a 3D Navier-Stokes problem
starting from the geometrical parameters of the domain and the boundary conditions.
The data are generated by solving the Navier-Stokes equations with the space-time reduced basis method (ST-RB).

## Data
The data are available at the following link: https://drive.switch.ch/index.php/s/vOWkcLFCy3bFbxa

The `data` folder is organized as follows:
- `basis`: contains the space-time reduced basis for the velocity and pressure.
- `RB_data`: contains the parameters (`parameter.npy`) and the solutions (`solutions.npy`) of the 2000 simulations. The solutions are already reduced in space-time.
- `geometries`: contains some geometrical files. It is only used for the exporting of the solutions.
- `misc`: some additional files. You can ignore them.
- 
The `data` folder must be placed in this folder.


## Content
The project contains the following files:
- `requirements.txt` contains the list of the required packages.
- two different folders, one for the velocity and one for the pressure, containing the following files:
  - one file (`grid_search_velocity.ipynb` and `grid_search_pressure.ipynb` respectively) for the grid search about the optimal architecture of the neural network.
  - one file (`run_velocity.ipynb` and `run_pressure.ipynb` respectively) with the best model for the prediction of the POD coefficients.
  - one file (`cross_validation_velocity.ipynb` and `cross_validation_pressure.ipynb` respectively) for the cross validation.
  - `utils.py` contains the import of external libraries, some useful functions to load the data and generate the visualization file.


## Requirements
The code is written in Python and the required packages are listed in `requirements.txt`. To install them, go to this folder and run the following 
command in the terminal:

``` 
pip install -r requirements.txt
```
We recommend to use a virtual environment to run the code.

## Run the code
The code is written in Jupyter Notebook. To run the code, open the desired file, follow the instructions within it and run the desired cells.

## Visualization of the results
To visualize the predicted solutions, which will be saved in `solutions_pred` 
folder, it is necessary to install Paraview (https://www.paraview.org/download/).
